<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TGCA Data Analysis  • tcgaCleaneR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="TGCA Data Analysis ">
<meta property="og:description" content="A system wrapped around SummarizedExperiment to analyse unwanted variations e.g. Batch Effect in TGCA datasets. Set of Data wrangling functions allows user to filter by specific genes, count of genes in samples, sample purity. User can run PCA, Correlation analysis, Anova test to study the variation in data in terms of PCs with respect to different variations.  ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">tcgaCleaneR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/tcgaCleaneR_vignette.html">TCGA Data Analysis using tcgaCleaneR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AbhishekSinha28/tcgaCleaneR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="tcgacleaner">tcgaCleaneR<a class="anchor" aria-label="anchor" href="#tcgacleaner"></a>
</h1></div>
<!-- badges: start -->
<p><img src="https://github.com/AbhishekSinha28/tcgaCleaneR/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"><!-- badges: end --></p>
<p>The goal of <code>tcgaCleaneR</code> is to provide a user-friendly R package to help Bioinformaticians with easy access to a tool that can perform Data Wrangling and Data Analysis on TCGA Pan Cancer Dataset. The package contains a subset of the original TCGA Breast Cancer Data collected from <a href="https://www.cbioportal.org/datasets" class="external-link">TCGA</a>. The package also contains a detailed set of functionalities that allows user to identify and handle unwanted variations in the TCGA datasets.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of tcgaCleaneR from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"AbhishekSinha28/tcgaCleaneR"</span>, ref<span class="op">=</span><span class="st">"master"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tcga-functionality">TCGA Functionality<a class="anchor" aria-label="anchor" href="#tcga-functionality"></a>
</h2>
<p>This is a quick walk trough of the <code>tcgaCleaneR</code> functionalities. For the detailed information on the Data Wrangling and Data Analysis functions and arguments in <code>tcgaCleaneR</code> package, you can consider looking at the vignette.</p>
<p>At present, TCGA Pan Cancer Datasets supports Cancer Biology for only <strong><em>four</em></strong> Cancer types. These four cancer type (TCGA datasets) are <em>Breast Cancer (BRCA)</em>, <em>Lung Cancer (LUAD)</em>, <em>Colon Cancer (COAD)</em> and <em>Rectum Cancer (READ)</em>. This implies that <em>RUV-III analysis</em> can only be performed for these four cancer types. This is because the RUV-III approach here requires at least one roughly known biologically homogeneous subclass of samples shared across sources of unwanted variation. Similarly, the vector correlation between Biology and PCs can only be viewed for these four Cancer types.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AbhishekSinha28/tcgaCleaneR">tcgaCleaneR</a></span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h1>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"brca.data"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brca.data</span>
<span class="co">#&gt; class: SummarizedExperiment </span>
<span class="co">#&gt; dim: 100 1196 </span>
<span class="co">#&gt; metadata(0):</span>
<span class="co">#&gt; assays(3): HTseq_counts HTseq_FPKM HTseq_FPKM.UQ</span>
<span class="co">#&gt; rownames(100): TSPAN6 TNMD ... CROT ABCB4</span>
<span class="co">#&gt; rowData names(9): EnsemblGene_ids Gene_symbol ...</span>
<span class="co">#&gt;   NanostringPanCancer_HK sinscorePanCancer_HK</span>
<span class="co">#&gt; colnames(1196): TCGA-A8-A06Z-01A-11R-A00Z-07</span>
<span class="co">#&gt;   TCGA-A8-A08F-01A-11R-A00Z-07 ... TCGA-5T-A9QA-01A-11R-A41B-07</span>
<span class="co">#&gt;   TCGA-BH-A0H9-11A-22R-A466-07</span>
<span class="co">#&gt; colData names(12): Samples Tissues ... CPE Subtypes</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="data-wrangling">Data Wrangling<a class="anchor" aria-label="anchor" href="#data-wrangling"></a>
</h1>
<div class="section level2">
<h2 id="gene-filter">Gene Filter<a class="anchor" aria-label="anchor" href="#gene-filter"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filtered.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/filterGenesByBiotypes.html">filterGenesByBiotypes</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">brca.data</span>,gene.type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"protein.coding"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="removing-lowly-expressed-genes">Removing lowly expressed genes<a class="anchor" aria-label="anchor" href="#removing-lowly-expressed-genes"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filtered.data1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/filterLowExprGenes.html">filterLowExprGenes</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">filtered.data</span>,gene_count <span class="op">=</span> <span class="fl">20</span>,sample_size <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="purity-filter---filter-samples-based-on-tumor-purity">Purity Filter - Filter Samples based on Tumor Purity<a class="anchor" aria-label="anchor" href="#purity-filter---filter-samples-based-on-tumor-purity"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filtered.data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/filterSamplesByPurity.html">filterSamplesByPurity</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">filtered.data1</span>,purity_cutoff<span class="op">=</span> <span class="fl">0.50</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="library-size-filter">Library Size Filter<a class="anchor" aria-label="anchor" href="#library-size-filter"></a>
</h2>
<div class="section level3">
<h3 id="determine-library-size">Determine Library Size<a class="anchor" aria-label="anchor" href="#determine-library-size"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/plotLibSize.html">plotLibSize</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">filtered.data2</span>, plot_type <span class="op">=</span> <span class="st">"Scatterplot"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="filter-samples-based-on-library-size">Filter samples based on library size<a class="anchor" aria-label="anchor" href="#filter-samples-based-on-library-size"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filtered.data3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/filterSamplesByLibSize.html">filterSamplesByLibSize</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">filtered.data2</span>, ls_cutoff <span class="op">=</span> <span class="fl">17.5</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="data-analysis">Data Analysis<a class="anchor" aria-label="anchor" href="#data-analysis"></a>
</h1>
<div class="section level2">
<h2 id="study-design-plot">Study Design Plot<a class="anchor" aria-label="anchor" href="#study-design-plot"></a>
</h2>
<p>The idea behind Study Design plot is to present the summarized information about the filtered data set using HeatMaps.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/plotStudyOutline.html">plotStudyOutline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">filtered.data3</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="pca">PCA<a class="anchor" aria-label="anchor" href="#pca"></a>
</h2>
<div class="section level3">
<h3 id="generate-pca">Generate PCA<a class="anchor" aria-label="anchor" href="#generate-pca"></a>
</h3>
<p>The principal components (in this context also called singular vectors) of the sample × transcript array of log-counts are the linear combinations of the transcript measurements having the largest, second largest, third largest, etc. variation, standardized to be of unit length and orthogonal to the preceding components. Each will give a single value for each sample.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Is data input for PCA logical</span>
<span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">is.logical</a></span><span class="op">(</span><span class="va">filtered.data3</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pca_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/computePCA.html">computePCA</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">filtered.data3</span>, nPcs <span class="op">=</span> <span class="fl">7</span>, is.log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-pca">Plot PCA<a class="anchor" aria-label="anchor" href="#plot-pca"></a>
</h3>
<p>Once we have the PCs generated using the PCA function the next step is to visualize those PCs with respect to the sample features like Time, Tissue, Plate etc., to identify any unwanted variation by identifying patterns in the plots by feature.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span>
<span class="va">pca.plot.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plotPC.html">plotPC</a></span><span class="op">(</span>pca.data <span class="op">=</span> <span class="va">pca_data</span>, data <span class="op">=</span> <span class="va">filtered.data3</span>, group <span class="op">=</span> <span class="st">"Time"</span>, plot_type <span class="op">=</span> <span class="st">"DensityPlot"</span>, pcs.no <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-14-1.png" width="100%" style="display: block; margin: auto;"><img src="reference/figures/README-unnamed-chunk-14-2.png" width="100%" style="display: block; margin: auto;"><img src="reference/figures/README-unnamed-chunk-14-3.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="pcs-correlation-with-unwanted-variations">PCs correlation with unwanted variations<a class="anchor" aria-label="anchor" href="#pcs-correlation-with-unwanted-variations"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="va">corr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plotPCsVar.html">plotPCsVar</a></span><span class="op">(</span>pca.data <span class="op">=</span> <span class="va">pca_data</span>, data <span class="op">=</span> <span class="va">filtered.data3</span>, type <span class="op">=</span> <span class="st">"purity"</span>, nPCs <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
<span class="va">corr_data</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level1">
<h1 id="ruv---iii">RUV - III<a class="anchor" aria-label="anchor" href="#ruv---iii"></a>
</h1>
<div class="section level2">
<h2 id="pseudo-replicate-pseudo-sampleprps-map">Pseudo Replicate Pseudo Sample(PRPS) Map<a class="anchor" aria-label="anchor" href="#pseudo-replicate-pseudo-sampleprps-map"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#library(tidyverse)</span>
<span class="fu"><a href="reference/plotPRPS.html">plotPRPS</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">filtered.data3</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="prps-generation">PRPS Generation<a class="anchor" aria-label="anchor" href="#prps-generation"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample.info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">filtered.data3</span><span class="op">)</span><span class="op">)</span>
<span class="va">expr.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">filtered.data3</span>, <span class="st">'HTseq_counts'</span><span class="op">)</span><span class="op">)</span> <span class="co"># gene expression data</span>
<span class="va">sample.info</span><span class="op">$</span><span class="va">ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">expr.data</span><span class="op">)</span> <span class="co"># adding library size variable</span>

<span class="va">df9</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/createPRPS.html">createPRPS</a></span><span class="op">(</span><span class="va">expr.data</span>, <span class="va">sample.info</span>, librarySize <span class="op">=</span> <span class="st">'ls'</span>, batch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Year'</span>, <span class="st">'Plates'</span><span class="op">)</span>, biology <span class="op">=</span> <span class="st">'Subtypes'</span>, purity<span class="op">=</span><span class="st">'Purity_singscore'</span>,include.ls<span class="op">=</span><span class="cn">T</span>, include.purity<span class="op">=</span><span class="cn">T</span>, minSamplesPerBatchPS <span class="op">=</span> <span class="fl">3</span>, minSamplesForPuirtyPS <span class="op">=</span> <span class="fl">3</span>, 
                 minSamplesForPurityPerBiology <span class="op">=</span> <span class="fl">12</span>, minSamplesForLibrarySizePerBatch <span class="op">=</span> <span class="fl">6</span>,
                 minSamplesForLibrarySizePS <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="ruv-iii">RUV-III<a class="anchor" aria-label="anchor" href="#ruv-iii"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### data input</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span>
<span class="co">### PRPS values</span>
<span class="va">prps.batch</span> <span class="op">&lt;-</span> <span class="va">df9</span><span class="op">$</span><span class="va">ps.batch</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">prps.batch</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">prps.batch</span><span class="op">)</span>,
  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'-'</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="op">)</span><span class="op">)</span>
<span class="va">prps.ls</span> <span class="op">&lt;-</span> <span class="va">df9</span><span class="op">$</span><span class="va">ps.ls</span>
<span class="va">prps.purity</span> <span class="op">&lt;-</span> <span class="va">df9</span><span class="op">$</span><span class="va">ps.purity</span>

<span class="va">raw.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">filtered.data3</span>, <span class="st">'HTseq_counts'</span><span class="op">)</span><span class="op">)</span>
<span class="va">ruv.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">raw.data</span> ,<span class="va">prps.batch</span> ,<span class="va">prps.ls</span>, <span class="va">prps.purity</span> <span class="op">)</span>
<span class="va">ruv.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">ruv.data</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># Taking Log </span>

<span class="co">### replicate matrix</span>
<span class="va">ruv.rep</span> <span class="op">&lt;-</span> <span class="fu">ruv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ruv/man/replicate.matrix.html" class="external-link">replicate.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">ruv.data</span><span class="op">)</span><span class="op">)</span>

<span class="va">gene.annot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">filtered.data3</span><span class="op">)</span><span class="op">)</span>

<span class="co">### NCG sets - Select House Keeping Genes</span>
<span class="va">ncg.set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ruv.data</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">gene.annot</span><span class="op">$</span><span class="va">Gene_symbol</span><span class="op">[</span><span class="va">gene.annot</span><span class="op">$</span><span class="va">RNAseq_HK</span> <span class="op">==</span> <span class="st">'yes'</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/LTLA/BiocSingular" class="external-link">BiocSingular</a></span><span class="op">)</span>
<span class="va">df10</span> <span class="op">&lt;-</span> <span class="fu">runRUVIII</span><span class="op">(</span>ruv.data <span class="op">=</span> <span class="va">ruv.data</span>, ruv.rep <span class="op">=</span> <span class="va">ruv.rep</span>, ncg.set <span class="op">=</span> <span class="va">ncg.set</span>, k<span class="op">=</span><span class="fl">1</span>, 
                BSPARAM <span class="op">=</span> <span class="fu">BiocSingular</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocSingular/man/BiocSingularParam.html" class="external-link">bsparam</a></span><span class="op">(</span><span class="op">)</span>, return.info <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="combined-analysis">Combined Analysis<a class="anchor" aria-label="anchor" href="#combined-analysis"></a>
</h1>
<div class="section level2">
<h2 id="combined-data">Combined data<a class="anchor" aria-label="anchor" href="#combined-data"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#library(SummarizedExperiment)</span>
<span class="va">gene.annot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">filtered.data3</span><span class="op">)</span><span class="op">)</span>

<span class="va">sample.info</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">filtered.data3</span><span class="op">)</span><span class="op">)</span>

<span class="va">ruv.iii.adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">df10</span><span class="op">$</span><span class="va">new.ruv.data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">raw.data</span><span class="op">)</span> , <span class="op">]</span><span class="op">)</span> <span class="co"># transpose</span>

<span class="va">raw.count</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">filtered.data3</span>, <span class="st">'HTseq_counts'</span><span class="op">)</span>
<span class="va">raw.count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">raw.count</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Taking Log </span>
<span class="va">fpkm</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">filtered.data3</span>, <span class="st">'HTseq_FPKM'</span><span class="op">)</span>
<span class="va">fpkm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">fpkm</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Taking Log </span>
<span class="va">fpkm.uq</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">filtered.data3</span>, <span class="st">'HTseq_FPKM.UQ'</span><span class="op">)</span>
<span class="va">fpkm.uq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">fpkm.uq</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Taking Log </span>
<span class="va">RUV_III</span> <span class="op">&lt;-</span> <span class="va">ruv.iii.adj</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></span><span class="op">(</span>assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>HTseq_counts <span class="op">=</span> <span class="va">raw.count</span>, HTseq_FPKM <span class="op">=</span> <span class="va">fpkm</span>,
                                                HTseq_FPKM.UQ <span class="op">=</span> <span class="va">fpkm.uq</span>, RUV_III <span class="op">=</span> <span class="va">RUV_III</span><span class="op">)</span>,
                                  colData <span class="op">=</span> <span class="va">sample.info</span>,
                                  rowData <span class="op">=</span> <span class="va">gene.annot</span><span class="op">)</span>

<span class="va">combined_data</span>
<span class="co">#&gt; class: SummarizedExperiment </span>
<span class="co">#&gt; dim: 96 266 </span>
<span class="co">#&gt; metadata(0):</span>
<span class="co">#&gt; assays(4): HTseq_counts HTseq_FPKM HTseq_FPKM.UQ RUV_III</span>
<span class="co">#&gt; rownames(96): TSPAN6 TNMD ... CROT ABCB4</span>
<span class="co">#&gt; rowData names(9): EnsemblGene_ids Gene_symbol ...</span>
<span class="co">#&gt;   NanostringPanCancer_HK sinscorePanCancer_HK</span>
<span class="co">#&gt; colnames(266): TCGA-A8-A06Z-01A-11R-A00Z-07</span>
<span class="co">#&gt;   TCGA-AN-A0AK-01A-21R-A00Z-07 ... TCGA-S3-AA11-01A-31R-A41B-07</span>
<span class="co">#&gt;   TCGA-AC-A4ZE-01A-11R-A41B-07</span>
<span class="co">#&gt; colData names(12): Samples Tissues ... CPE Subtypes</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pca-on-combined-data">PCA on Combined Data<a class="anchor" aria-label="anchor" href="#pca-on-combined-data"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df11</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/computePCA.html">computePCA</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">combined_data</span>, nPcs <span class="op">=</span> <span class="fl">7</span>, is.log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pcs-correlation-with-unwanted-variations-in-combined-data">PCs correlation with unwanted variations in Combined Data<a class="anchor" aria-label="anchor" href="#pcs-correlation-with-unwanted-variations-in-combined-data"></a>
</h2>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df12</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plotPCsVar.html">plotPCsVar</a></span><span class="op">(</span>pca.data <span class="op">=</span> <span class="va">df11</span>, data <span class="op">=</span> <span class="va">combined_data</span>, type <span class="op">=</span> <span class="st">"purity"</span>, nPCs <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
<span class="va">df12</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-23-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/AbhishekSinha28/tcgaCleaneR/">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tcgaCleaneR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Abhishek Sinha <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Abhishek Sinha.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
