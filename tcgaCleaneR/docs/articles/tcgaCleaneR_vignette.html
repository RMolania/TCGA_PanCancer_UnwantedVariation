<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TCGA Data Analysis using tcgaCleaneR â€¢ tcgaCleaneR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="TCGA Data Analysis using tcgaCleaneR">
<meta property="og:description" content="tcgaCleaneR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tcgaCleaneR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tcgaCleaneR_vignette.html">TCGA Data Analysis using tcgaCleaneR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AbhishekSinha28/tcgaCleaneR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>TCGA Data Analysis using tcgaCleaneR</h1>
                        <h4 data-toc-skip class="author">Abhishek Sinha</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AbhishekSinha28/tcgaCleaneR/blob/HEAD/vignettes/tcgaCleaneR_vignette.Rmd"><code>vignettes/tcgaCleaneR_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>tcgaCleaneR_vignette.Rmd</code></div>

    </div>

    
    
<p>Last updated on: 2022-05-03</p>
<style type="text/css">
h1.title {
  font-size: 28px;
  color: DarkRed;
}
h1 { /* Header 1 */
  font-size: 24px;
  color: DarkBlue;
}
h2 { /* Header 2 */
    font-size: 20px;
  color: DarkBlue;
}
h3 { /* Header 3 */
    font-size: 18px;
  color: DarkBlue;
}
h4 { /* Header 3 */
    font-size: 16px;
  color: DarkBlue;
}
</style>
<style>
p.caption {
  font-size: 46em;
  font-style: italic;
  color: black;
}
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The Cancer Genome Atlas (TCGA) datasets are an extensive set of Cancer datasets widely used in Cancer research and clinical publications. The TCGA Research Network has cataloged different molecular information of 33 human cancer types to increase our biological insight into cancers. One major aspect of TCGA cancer research uses the gene expression data gathered from the Gene expression experiments that are conducted to better understand the biological mechanisms in cells and tissues. But Gene expression data is almost always compromised by unwanted variation that may lead to inaccurate and wrong biological results and retractions. Effective removal of unwanted variation such as batch effects is one of the main challenges of the analysis of gene expression data, particularly when the data comes from large and complex experiments.</p>
<p>The goal of the <strong><em>tcgaCleaneR</em></strong> package is to minimize this challenge and help users to analyse and handle these unwanted variations. This package acts as a tool to let users account for the unwanted variations in their research and publications.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AbhishekSinha28/tcgaCleaneR">tcgaCleaneR</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"brca.data"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brca.data</span>
<span class="co">#&gt; class: SummarizedExperiment </span>
<span class="co">#&gt; dim: 100 1196 </span>
<span class="co">#&gt; metadata(0):</span>
<span class="co">#&gt; assays(3): HTseq_counts HTseq_FPKM HTseq_FPKM.UQ</span>
<span class="co">#&gt; rownames(100): TSPAN6 TNMD ... CROT ABCB4</span>
<span class="co">#&gt; rowData names(9): EnsemblGene_ids Gene_symbol ...</span>
<span class="co">#&gt;   NanostringPanCancer_HK sinscorePanCancer_HK</span>
<span class="co">#&gt; colnames(1196): TCGA-A8-A06Z-01A-11R-A00Z-07</span>
<span class="co">#&gt;   TCGA-A8-A08F-01A-11R-A00Z-07 ... TCGA-5T-A9QA-01A-11R-A41B-07</span>
<span class="co">#&gt;   TCGA-BH-A0H9-11A-22R-A466-07</span>
<span class="co">#&gt; colData names(12): Samples Tissues ... CPE Subtypes</span></code></pre></div>
<p>The package contains a highly condensed version of the original dataset with 100 unique genes and 1196 samples. The data consists three individual data that can be accessed using . Sample meta-data describing the samples can be accessed using , and is a DataFrame that can store any number of descriptive columns for each sample row. Similarly, Gene meta-data describing the genes can be accessed using , and is a DataFrame that can store any number of descriptive columns for each gene row.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gene.annot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">brca.data</span><span class="op">)</span><span class="op">)</span>
<span class="va">sample.info</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">brca.data</span><span class="op">)</span><span class="op">)</span>
<span class="va">raw.count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">brca.data</span>, <span class="st">'HTseq_counts'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-wrangling">Data Wrangling<a class="anchor" aria-label="anchor" href="#data-wrangling"></a>
</h2>
<div class="section level3">
<h3 id="gene-filter">Gene Filter<a class="anchor" aria-label="anchor" href="#gene-filter"></a>
</h3>
<div class="section level4">
<h4 id="filter-data-by-specific-gene-">Filter data by specific gene.<a class="anchor" aria-label="anchor" href="#filter-data-by-specific-gene-"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filterGenesByBiotypes.html">filterGenesByBiotypes</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">brca.data</span>,gene.type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"protein.coding"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="removing-lowly-expressed-genes">Removing lowly expressed genes<a class="anchor" aria-label="anchor" href="#removing-lowly-expressed-genes"></a>
</h3>
<div class="section level4">
<h4 id="filter-data-for-genes-with-low-count-set-number-of-samples">Filter data for genes with low count set number of samples<a class="anchor" aria-label="anchor" href="#filter-data-for-genes-with-low-count-set-number-of-samples"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filterLowExprGenes.html">filterLowExprGenes</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df1</span>,gene_count <span class="op">=</span> <span class="fl">20</span>,sample_size <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="purity-filter">Purity Filter<a class="anchor" aria-label="anchor" href="#purity-filter"></a>
</h3>
<div class="section level4">
<h4 id="filter-samples-based-on-tumor-purity">Filter Samples based on Tumor Purity<a class="anchor" aria-label="anchor" href="#filter-samples-based-on-tumor-purity"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filterSamplesByPurity.html">filterSamplesByPurity</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">df2</span>,purity_cutoff<span class="op">=</span> <span class="fl">0.496</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="library-size-filter">Library Size Filter<a class="anchor" aria-label="anchor" href="#library-size-filter"></a>
</h3>
<div class="section level4">
<h4 id="determine-library-size">Determine Library Size<a class="anchor" aria-label="anchor" href="#determine-library-size"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotLibSize.html">plotLibSize</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df3</span>, plot_type <span class="op">=</span> <span class="st">"Scatterplot"</span><span class="op">)</span></code></pre></div>
<p><img src="tcgaCleaneR_vignette_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="filter-samples-based-on-library-size">Filter samples based on library size<a class="anchor" aria-label="anchor" href="#filter-samples-based-on-library-size"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filterSamplesByLibSize.html">filterSamplesByLibSize</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df3</span>, ls_cutoff <span class="op">=</span> <span class="fl">17.5</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="data-analysis">Data Analysis<a class="anchor" aria-label="anchor" href="#data-analysis"></a>
</h2>
<div class="section level3">
<h3 id="study-design-plot">Study Design Plot<a class="anchor" aria-label="anchor" href="#study-design-plot"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotStudyOutline.html">plotStudyOutline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df4</span><span class="op">)</span></code></pre></div>
<p><img src="tcgaCleaneR_vignette_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="pca">PCA<a class="anchor" aria-label="anchor" href="#pca"></a>
</h3>
<div class="section level4">
<h4 id="generate-pca">Generate PCA<a class="anchor" aria-label="anchor" href="#generate-pca"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Is data input for PCA logical</span>
<span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">is.logical</a></span><span class="op">(</span><span class="va">df4</span><span class="op">)</span>
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePCA.html">computePCA</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df4</span>, nPcs <span class="op">=</span> <span class="fl">7</span>, is.log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Generated 7 PCs for first two genes</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df5</span><span class="op">[[</span><span class="st">'HTseq_counts'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">sing.val</span><span class="op">$</span><span class="va">u</span>,<span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;                                    [,1]        [,2]        [,3]       [,4]</span>
<span class="co">#&gt; TCGA-A8-A06Z-01A-11R-A00Z-07 0.00837821 -0.04277808 0.049303063 -0.1373556</span>
<span class="co">#&gt; TCGA-AN-A0AK-01A-21R-A00Z-07 0.08050782  0.01882850 0.008960697  0.1368417</span>
<span class="co">#&gt;                                     [,5]        [,6]       [,7]</span>
<span class="co">#&gt; TCGA-A8-A06Z-01A-11R-A00Z-07 -0.01708428 -0.02702201 0.03422395</span>
<span class="co">#&gt; TCGA-AN-A0AK-01A-21R-A00Z-07 -0.04703139  0.03489068 0.06995316</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plot-pca">Plot PCA<a class="anchor" aria-label="anchor" href="#plot-pca"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/plotPC.html">plotPC</a></span><span class="op">(</span>pca.data <span class="op">=</span> <span class="va">df5</span>, data <span class="op">=</span> <span class="va">df4</span>, group <span class="op">=</span> <span class="st">"Time"</span>, plot_type <span class="op">=</span> <span class="st">"DensityPlot"</span>, pcs.no <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="tcgaCleaneR_vignette_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"><img src="tcgaCleaneR_vignette_files/figure-html/unnamed-chunk-14-2.png" width="672" style="display: block; margin: auto;"><img src="tcgaCleaneR_vignette_files/figure-html/unnamed-chunk-14-3.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="pcs-correlation-with-unwanted-variations">PCs correlation with unwanted variations<a class="anchor" aria-label="anchor" href="#pcs-correlation-with-unwanted-variations"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="va">df6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotPCsVar.html">plotPCsVar</a></span><span class="op">(</span>pca.data <span class="op">=</span> <span class="va">df5</span>, data <span class="op">=</span> <span class="va">df4</span>, type <span class="op">=</span> <span class="st">"purity"</span>, nPCs <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
<span class="va">df6</span></code></pre></div>
<p><img src="tcgaCleaneR_vignette_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="gene-correlation">Gene correlation<a class="anchor" aria-label="anchor" href="#gene-correlation"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeCorr.html">computeCorr</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df4</span>, is.log <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="st">"librarysize"</span>, cor.method <span class="op">=</span> <span class="st">'spearman'</span>, n.cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="tcgaCleaneR_vignette_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df7</span><span class="op">)</span>
<span class="co">#&gt;      genes       rho       pvalue   adj.pvalue</span>
<span class="co">#&gt; 1   TSPAN6 -0.014011 8.141417e-01 8.227117e-01</span>
<span class="co">#&gt; 2     TNMD  0.101134 8.890726e-02 1.016083e-01</span>
<span class="co">#&gt; 3     DPM1  0.454888 6.550866e-16 2.734274e-15</span>
<span class="co">#&gt; 4    SCYL3  0.424801 7.165718e-14 2.645804e-13</span>
<span class="co">#&gt; 5 C1orf112  0.415310 2.868200e-13 9.494731e-13</span>
<span class="co">#&gt; 6      FGR  0.194973 9.565599e-04 1.350438e-03</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="anova-test">Anova Test<a class="anchor" aria-label="anchor" href="#anova-test"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computeANOVA.html">computeANOVA</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df4</span>, variable <span class="op">=</span> <span class="st">"Time"</span>, is.log <span class="op">=</span> <span class="cn">FALSE</span>, n.cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df8</span><span class="op">)</span>
<span class="co">#&gt;             Genes FValue       PValue   Adj.PValue  Mean</span>
<span class="co">#&gt; TSPAN6     TSPAN6 1.8204 1.250015e-01 0.2068990263 11.82</span>
<span class="co">#&gt; TNMD         TNMD 0.3240 8.617789e-01 0.8992475772  4.88</span>
<span class="co">#&gt; DPM1         DPM1 6.4205 5.901803e-05 0.0002463361 11.35</span>
<span class="co">#&gt; SCYL3       SCYL3 5.4375 3.140347e-04 0.0011595126 11.08</span>
<span class="co">#&gt; C1orf112 C1orf112 3.3842 1.004762e-02 0.0224318996  9.88</span>
<span class="co">#&gt; FGR           FGR 3.1498 1.482167e-02 0.0323381873  8.06</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="ruv---iii">RUV - III<a class="anchor" aria-label="anchor" href="#ruv---iii"></a>
</h2>
<div class="section level3">
<h3 id="check-ncg-sets">Check NCG Sets<a class="anchor" aria-label="anchor" href="#check-ncg-sets"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/checkNegCtrlGenes.html">checkNegCtrlGenes</a></span><span class="op">(</span>data <span class="op">=</span><span class="va">df4</span>, ncg_set<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Microrray_HK"</span><span class="op">)</span>, group<span class="op">=</span><span class="st">'Time'</span>, plot_type<span class="op">=</span><span class="st">"DensityPlot"</span>, nPcs<span class="op">=</span><span class="fl">10</span>, npcs <span class="op">=</span> <span class="fl">3</span>, is.log<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="tcgaCleaneR_vignette_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="prps-map">PRPS Map<a class="anchor" aria-label="anchor" href="#prps-map"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/plotPRPS.html">plotPRPS</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df4</span><span class="op">)</span></code></pre></div>
<p><img src="tcgaCleaneR_vignette_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="prps-generation">PRPS Generation<a class="anchor" aria-label="anchor" href="#prps-generation"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample.info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">df4</span><span class="op">)</span><span class="op">)</span>
<span class="va">expr.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">df4</span>, <span class="st">'HTseq_counts'</span><span class="op">)</span><span class="op">)</span> <span class="co"># gene expression data</span>
<span class="va">sample.info</span><span class="op">$</span><span class="va">ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">expr.data</span><span class="op">)</span> <span class="co"># adding library size variable</span>

<span class="va">df9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createPRPS.html">createPRPS</a></span><span class="op">(</span><span class="va">expr.data</span>, <span class="va">sample.info</span>, librarySize <span class="op">=</span> <span class="st">'ls'</span>, batch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Year'</span>, <span class="st">'Plates'</span><span class="op">)</span>, biology <span class="op">=</span> <span class="st">'Subtypes'</span>, purity<span class="op">=</span><span class="st">'Purity_singscore'</span>,include.ls<span class="op">=</span><span class="cn">T</span>, include.purity<span class="op">=</span><span class="cn">T</span>, minSamplesPerBatchPS <span class="op">=</span> <span class="fl">3</span>, minSamplesForPuirtyPS <span class="op">=</span> <span class="fl">3</span>, 
                 minSamplesForPurityPerBiology <span class="op">=</span> <span class="fl">12</span>, minSamplesForLibrarySizePerBatch <span class="op">=</span> <span class="fl">6</span>,
                 minSamplesForLibrarySizePS <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; PRPS are generated for batch effects</span>
<span class="co">#&gt; PRPS are generated for library size effects</span>
<span class="co">#&gt; PRPS are generated for purity effects</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ruv-iii">RUV-III<a class="anchor" aria-label="anchor" href="#ruv-iii"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### data input</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span>
<span class="co">### PRPS values</span>
<span class="va">prps.batch</span> <span class="op">&lt;-</span> <span class="va">df9</span><span class="op">$</span><span class="va">ps.batch</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">prps.batch</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">prps.batch</span><span class="op">)</span>,
  <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'-'</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="op">)</span><span class="op">)</span>
<span class="va">prps.ls</span> <span class="op">&lt;-</span> <span class="va">df9</span><span class="op">$</span><span class="va">ps.ls</span>
<span class="va">prps.purity</span> <span class="op">&lt;-</span> <span class="va">df9</span><span class="op">$</span><span class="va">ps.purity</span>

<span class="va">raw.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">df4</span>, <span class="st">'HTseq_counts'</span><span class="op">)</span><span class="op">)</span>
<span class="va">ruv.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">raw.data</span> ,<span class="va">prps.batch</span> ,<span class="va">prps.ls</span>, <span class="va">prps.purity</span> <span class="op">)</span>
<span class="va">ruv.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">ruv.data</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="co">### replicate matrix</span>
<span class="va">ruv.rep</span> <span class="op">&lt;-</span> <span class="fu">ruv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ruv/man/replicate.matrix.html" class="external-link">replicate.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">ruv.data</span><span class="op">)</span><span class="op">)</span>

<span class="va">gene.annot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">df4</span><span class="op">)</span><span class="op">)</span>

<span class="co">### NCG sets</span>
<span class="va">ncg.set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">ruv.data</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">gene.annot</span><span class="op">$</span><span class="va">Gene_symbol</span><span class="op">[</span><span class="va">gene.annot</span><span class="op">$</span><span class="va">RNAseq_HK</span> <span class="op">==</span> <span class="st">'yes'</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#library(BiocParallel)</span>
<span class="co">#library(BiocSingular)</span>
<span class="va">df10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runRUV_III_PRPS.html">runRUV_III_PRPS</a></span><span class="op">(</span>ruv.data <span class="op">=</span> <span class="va">ruv.data</span>, ruv.rep <span class="op">=</span> <span class="va">ruv.rep</span>, ncg.set <span class="op">=</span> <span class="va">ncg.set</span>, k<span class="op">=</span><span class="fl">1</span>, return.info <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="combined-analysis">Combined Analysis<a class="anchor" aria-label="anchor" href="#combined-analysis"></a>
</h2>
<div class="section level3">
<h3 id="combined-data">Combined data<a class="anchor" aria-label="anchor" href="#combined-data"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#library(SummarizedExperiment)</span>
<span class="va">gene.annot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">df4</span><span class="op">)</span><span class="op">)</span>

<span class="va">sample.info</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">df4</span><span class="op">)</span><span class="op">)</span>

<span class="va">ruv.iii.adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">df10</span><span class="op">$</span><span class="va">new.ruv.data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">raw.data</span><span class="op">)</span> , <span class="op">]</span><span class="op">)</span> <span class="co"># transpose</span>

<span class="va">raw.count</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">df4</span>, <span class="st">'HTseq_counts'</span><span class="op">)</span>
<span class="va">raw.count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">raw.count</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">fpkm</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">df4</span>, <span class="st">'HTseq_FPKM'</span><span class="op">)</span>
<span class="va">fpkm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">fpkm</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">fpkm.uq</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">df4</span>, <span class="st">'HTseq_FPKM.UQ'</span><span class="op">)</span>
<span class="va">fpkm.uq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">fpkm.uq</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">RUV_III</span> <span class="op">&lt;-</span> <span class="va">ruv.iii.adj</span>

<span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></span><span class="op">(</span>assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>HTseq_counts <span class="op">=</span> <span class="va">raw.count</span>, HTseq_FPKM <span class="op">=</span> <span class="va">fpkm</span>,
                                                HTseq_FPKM.UQ <span class="op">=</span> <span class="va">fpkm.uq</span>, RUV_III <span class="op">=</span> <span class="va">RUV_III</span><span class="op">)</span>,
                                  colData <span class="op">=</span> <span class="va">sample.info</span>,
                                  rowData <span class="op">=</span> <span class="va">gene.annot</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pca-on-combined-data">PCA on Combined Data<a class="anchor" aria-label="anchor" href="#pca-on-combined-data"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/computePCA.html">computePCA</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">combined_data</span>, nPcs <span class="op">=</span> <span class="fl">7</span>, is.log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-pca-for-combined-data">Plot PCA for Combined Data<a class="anchor" aria-label="anchor" href="#plot-pca-for-combined-data"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotPC.html">plotPC</a></span><span class="op">(</span>pca.data <span class="op">=</span> <span class="va">df11</span>, data <span class="op">=</span> <span class="va">combined_data</span>, group <span class="op">=</span> <span class="st">"Time"</span>, plot_type <span class="op">=</span> <span class="st">"DensityPlot"</span>, pcs.no <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pcs-correlation-with-unwanted-variations-in-combined-data">PCs correlation with unwanted variations in Combined Data<a class="anchor" aria-label="anchor" href="#pcs-correlation-with-unwanted-variations-in-combined-data"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotPCsVar.html">plotPCsVar</a></span><span class="op">(</span>pca.data <span class="op">=</span> <span class="va">df11</span>, data <span class="op">=</span> <span class="va">combined_data</span>, type <span class="op">=</span> <span class="st">"purity"</span>, nPCs <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
<span class="va">df12</span></code></pre></div>
<p><img src="tcgaCleaneR_vignette_files/figure-html/unnamed-chunk-26-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Abhishek Sinha.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
